{"version":3,"file":"_server.ts-6CQJIfsx.js","sources":["../../../.svelte-kit/adapter-node/entries/endpoints/containers/_server.ts.js"],"sourcesContent":["import { u as unauthorizedJson, j as json } from \"../../../chunks/json.js\";\nimport { k as knownServices } from \"../../../chunks/init.js\";\nimport { composeList, composePull } from \"../../../chunks/compose-runner.js\";\nfunction hasNewerImage(pullOutput) {\n  if (pullOutput.includes(\"Downloaded newer image\")) return true;\n  if (pullOutput.includes(\"Image is up to date\")) return false;\n  return false;\n}\nconst GET = async ({ locals }) => {\n  if (!locals.authenticated) return unauthorizedJson();\n  const services = Array.from(await knownServices()).sort();\n  const psResult = await composeList();\n  const runningByService = /* @__PURE__ */ new Map();\n  if (psResult.ok) {\n    try {\n      const rows = JSON.parse(psResult.stdout);\n      for (const row of rows) {\n        const service = String(row.Service ?? row.Name ?? \"\");\n        if (!service) continue;\n        runningByService.set(service, {\n          status: String(row.State ?? row.Status ?? \"unknown\"),\n          image: String(row.Image ?? \"unknown\")\n        });\n      }\n    } catch {\n    }\n  }\n  const details = [];\n  for (const service of services) {\n    const pullResult = await composePull(service);\n    const pullOutput = `${pullResult.stdout}\n${pullResult.stderr}`;\n    details.push({\n      name: service,\n      status: runningByService.get(service)?.status ?? \"not_running\",\n      image: runningByService.get(service)?.image ?? \"unknown\",\n      updateAvailable: pullResult.ok && hasNewerImage(pullOutput)\n    });\n  }\n  return json(200, { services: details });\n};\nexport {\n  GET\n};\n"],"names":[],"mappings":";;;;;;;;;;;;AAGA,SAAS,aAAa,CAAC,UAAU,EAAE;AACnC,EAAE,IAAI,UAAU,CAAC,QAAQ,CAAC,wBAAwB,CAAC,EAAE,OAAO,IAAI;AAChE,EAAE,IAAI,UAAU,CAAC,QAAQ,CAAC,qBAAqB,CAAC,EAAE,OAAO,KAAK;AAC9D,EAAE,OAAO,KAAK;AACd;AACK,MAAC,GAAG,GAAG,OAAO,EAAE,MAAM,EAAE,KAAK;AAClC,EAAE,IAAI,CAAC,MAAM,CAAC,aAAa,EAAE,OAAO,gBAAgB,EAAE;AACtD,EAAE,MAAM,QAAQ,GAAG,KAAK,CAAC,IAAI,CAAC,MAAM,aAAa,EAAE,CAAC,CAAC,IAAI,EAAE;AAC3D,EAAE,MAAM,QAAQ,GAAG,MAAM,WAAW,EAAE;AACtC,EAAE,MAAM,gBAAgB,mBAAmB,IAAI,GAAG,EAAE;AACpD,EAAE,IAAI,QAAQ,CAAC,EAAE,EAAE;AACnB,IAAI,IAAI;AACR,MAAM,MAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC;AAC9C,MAAM,KAAK,MAAM,GAAG,IAAI,IAAI,EAAE;AAC9B,QAAQ,MAAM,OAAO,GAAG,MAAM,CAAC,GAAG,CAAC,OAAO,IAAI,GAAG,CAAC,IAAI,IAAI,EAAE,CAAC;AAC7D,QAAQ,IAAI,CAAC,OAAO,EAAE;AACtB,QAAQ,gBAAgB,CAAC,GAAG,CAAC,OAAO,EAAE;AACtC,UAAU,MAAM,EAAE,MAAM,CAAC,GAAG,CAAC,KAAK,IAAI,GAAG,CAAC,MAAM,IAAI,SAAS,CAAC;AAC9D,UAAU,KAAK,EAAE,MAAM,CAAC,GAAG,CAAC,KAAK,IAAI,SAAS;AAC9C,SAAS,CAAC;AACV,MAAM;AACN,IAAI,CAAC,CAAC,MAAM;AACZ,IAAI;AACJ,EAAE;AACF,EAAE,MAAM,OAAO,GAAG,EAAE;AACpB,EAAE,KAAK,MAAM,OAAO,IAAI,QAAQ,EAAE;AAClC,IAAI,MAAM,UAAU,GAAG,MAAM,WAAW,CAAC,OAAO,CAAC;AACjD,IAAI,MAAM,UAAU,GAAG,CAAC,EAAE,UAAU,CAAC,MAAM;AAC3C,EAAE,UAAU,CAAC,MAAM,CAAC,CAAC;AACrB,IAAI,OAAO,CAAC,IAAI,CAAC;AACjB,MAAM,IAAI,EAAE,OAAO;AACnB,MAAM,MAAM,EAAE,gBAAgB,CAAC,GAAG,CAAC,OAAO,CAAC,EAAE,MAAM,IAAI,aAAa;AACpE,MAAM,KAAK,EAAE,gBAAgB,CAAC,GAAG,CAAC,OAAO,CAAC,EAAE,KAAK,IAAI,SAAS;AAC9D,MAAM,eAAe,EAAE,UAAU,CAAC,EAAE,IAAI,aAAa,CAAC,UAAU;AAChE,KAAK,CAAC;AACN,EAAE;AACF,EAAE,OAAO,IAAI,CAAC,GAAG,EAAE,EAAE,QAAQ,EAAE,OAAO,EAAE,CAAC;AACzC;;;;"}