{"version":3,"file":"auth-0WRDks2O.js","sources":["../../../.svelte-kit/adapter-node/chunks/auth.js"],"sourcesContent":["import { createHmac, timingSafeEqual } from \"node:crypto\";\nimport { A as ADMIN_TOKEN, i as DEFAULT_INSECURE_TOKEN } from \"./config.js\";\nconst TOKEN_HMAC_KEY = \"openpalm-token-compare\";\nfunction hmacCompare(a, b) {\n  const hmacA = createHmac(\"sha256\", TOKEN_HMAC_KEY).update(a).digest();\n  const hmacB = createHmac(\"sha256\", TOKEN_HMAC_KEY).update(b).digest();\n  return timingSafeEqual(hmacA, hmacB);\n}\nfunction verifyAdminToken(token) {\n  if (ADMIN_TOKEN === DEFAULT_INSECURE_TOKEN) return false;\n  if (!ADMIN_TOKEN) return false;\n  return hmacCompare(token, ADMIN_TOKEN);\n}\nfunction isLocalRequest(request) {\n  const forwarded = request.headers.get(\"x-forwarded-for\");\n  const ip = forwarded?.split(\",\")[0]?.trim() ?? \"127.0.0.1\";\n  const localPatterns = [\n    \"127.0.0.1\",\n    \"::1\",\n    \"10.\",\n    \"172.16.\",\n    \"172.17.\",\n    \"172.18.\",\n    \"172.19.\",\n    \"172.20.\",\n    \"172.21.\",\n    \"172.22.\",\n    \"172.23.\",\n    \"172.24.\",\n    \"172.25.\",\n    \"172.26.\",\n    \"172.27.\",\n    \"172.28.\",\n    \"172.29.\",\n    \"172.30.\",\n    \"172.31.\",\n    \"192.168.\"\n  ];\n  return localPatterns.some((p) => ip.startsWith(p));\n}\nexport {\n  isLocalRequest as i,\n  verifyAdminToken as v\n};\n"],"names":[],"mappings":";;;AAEA,MAAM,cAAc,GAAG,wBAAwB;AAC/C,SAAS,WAAW,CAAC,CAAC,EAAE,CAAC,EAAE;AAC3B,EAAE,MAAM,KAAK,GAAG,UAAU,CAAC,QAAQ,EAAE,cAAc,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,MAAM,EAAE;AACvE,EAAE,MAAM,KAAK,GAAG,UAAU,CAAC,QAAQ,EAAE,cAAc,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,MAAM,EAAE;AACvE,EAAE,OAAO,eAAe,CAAC,KAAK,EAAE,KAAK,CAAC;AACtC;AACA,SAAS,gBAAgB,CAAC,KAAK,EAAE;AACjC,EAAE,IAAI,WAAW,KAAK,sBAAsB,EAAE,OAAO,KAAK;AAC1D,EAAE,IAAI,CAAC,WAAW,EAAE,OAAO,KAAK;AAChC,EAAE,OAAO,WAAW,CAAC,KAAK,EAAE,WAAW,CAAC;AACxC;AACA,SAAS,cAAc,CAAC,OAAO,EAAE;AACjC,EAAE,MAAM,SAAS,GAAG,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,iBAAiB,CAAC;AAC1D,EAAE,MAAM,EAAE,GAAG,SAAS,EAAE,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,IAAI,WAAW;AAC5D,EAAE,MAAM,aAAa,GAAG;AACxB,IAAI,WAAW;AACf,IAAI,KAAK;AACT,IAAI,KAAK;AACT,IAAI,SAAS;AACb,IAAI,SAAS;AACb,IAAI,SAAS;AACb,IAAI,SAAS;AACb,IAAI,SAAS;AACb,IAAI,SAAS;AACb,IAAI,SAAS;AACb,IAAI,SAAS;AACb,IAAI,SAAS;AACb,IAAI,SAAS;AACb,IAAI,SAAS;AACb,IAAI,SAAS;AACb,IAAI,SAAS;AACb,IAAI,SAAS;AACb,IAAI,SAAS;AACb,IAAI,SAAS;AACb,IAAI;AACJ,GAAG;AACH,EAAE,OAAO,aAAa,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,EAAE,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;AACpD;;;;"}