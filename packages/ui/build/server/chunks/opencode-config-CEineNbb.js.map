{"version":3,"file":"opencode-config-CEineNbb.js","sources":["../../../.svelte-kit/adapter-node/chunks/opencode-config.js"],"sourcesContent":["import { existsSync, readFileSync, writeFileSync, mkdirSync } from \"node:fs\";\nimport { dirname } from \"node:path\";\nimport { b as OPENCODE_CONFIG_PATH } from \"./config.js\";\nfunction parseJsonc(input) {\n  const stripped = input.replace(/\\/\\*[\\s\\S]*?\\*\\//g, \"\").replace(/^\\s*\\/\\/.*$/gm, \"\");\n  return JSON.parse(stripped);\n}\nfunction stringifyPretty(value) {\n  return JSON.stringify(value, null, 2) + \"\\n\";\n}\nfunction ensureOpencodeConfigPath() {\n  if (existsSync(OPENCODE_CONFIG_PATH)) return;\n  mkdirSync(dirname(OPENCODE_CONFIG_PATH), { recursive: true });\n  writeFileSync(OPENCODE_CONFIG_PATH, '{\\n  \"plugin\": []\\n}\\n', \"utf8\");\n}\nfunction applySmallModelToOpencodeConfig(endpoint, modelId) {\n  if (!modelId || !existsSync(OPENCODE_CONFIG_PATH)) return;\n  const raw = readFileSync(OPENCODE_CONFIG_PATH, \"utf8\");\n  const doc = parseJsonc(raw);\n  doc.small_model = modelId;\n  if (endpoint) {\n    const parts = modelId.split(\"/\");\n    const providerId = parts.length > 1 ? parts[0] : \"openpalm-small\";\n    const providers = typeof doc.provider === \"object\" && doc.provider !== null ? { ...doc.provider } : {};\n    const providerOptions = { baseURL: endpoint };\n    providerOptions.apiKey = \"{env:OPENPALM_SMALL_MODEL_API_KEY}\";\n    providers[providerId] = { options: providerOptions };\n    doc.provider = providers;\n  }\n  writeFileSync(OPENCODE_CONFIG_PATH, stringifyPretty(doc), \"utf8\");\n}\nfunction readInstalledPlugins() {\n  ensureOpencodeConfigPath();\n  const raw = readFileSync(OPENCODE_CONFIG_PATH, \"utf8\");\n  const doc = parseJsonc(raw);\n  return Array.isArray(doc.plugin) ? doc.plugin.filter((value) => typeof value === \"string\") : [];\n}\nexport {\n  applySmallModelToOpencodeConfig as a,\n  readInstalledPlugins as r\n};\n"],"names":[],"mappings":";;;;AAGA,SAAS,UAAU,CAAC,KAAK,EAAE;AAC3B,EAAE,MAAM,QAAQ,GAAG,KAAK,CAAC,OAAO,CAAC,mBAAmB,EAAE,EAAE,CAAC,CAAC,OAAO,CAAC,eAAe,EAAE,EAAE,CAAC;AACtF,EAAE,OAAO,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC;AAC7B;AACA,SAAS,eAAe,CAAC,KAAK,EAAE;AAChC,EAAE,OAAO,IAAI,CAAC,SAAS,CAAC,KAAK,EAAE,IAAI,EAAE,CAAC,CAAC,GAAG,IAAI;AAC9C;AACA,SAAS,wBAAwB,GAAG;AACpC,EAAE,IAAI,UAAU,CAAC,oBAAoB,CAAC,EAAE;AACxC,EAAE,SAAS,CAAC,OAAO,CAAC,oBAAoB,CAAC,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC;AAC/D,EAAE,aAAa,CAAC,oBAAoB,EAAE,wBAAwB,EAAE,MAAM,CAAC;AACvE;AACA,SAAS,+BAA+B,CAAC,QAAQ,EAAE,OAAO,EAAE;AAC5D,EAAE,IAAI,CAAC,OAAO,IAAI,CAAC,UAAU,CAAC,oBAAoB,CAAC,EAAE;AACrD,EAAE,MAAM,GAAG,GAAG,YAAY,CAAC,oBAAoB,EAAE,MAAM,CAAC;AACxD,EAAE,MAAM,GAAG,GAAG,UAAU,CAAC,GAAG,CAAC;AAC7B,EAAE,GAAG,CAAC,WAAW,GAAG,OAAO;AAC3B,EAAE,IAAI,QAAQ,EAAE;AAChB,IAAI,MAAM,KAAK,GAAG,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC;AACpC,IAAI,MAAM,UAAU,GAAG,KAAK,CAAC,MAAM,GAAG,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,GAAG,gBAAgB;AACrE,IAAI,MAAM,SAAS,GAAG,OAAO,GAAG,CAAC,QAAQ,KAAK,QAAQ,IAAI,GAAG,CAAC,QAAQ,KAAK,IAAI,GAAG,EAAE,GAAG,GAAG,CAAC,QAAQ,EAAE,GAAG,EAAE;AAC1G,IAAI,MAAM,eAAe,GAAG,EAAE,OAAO,EAAE,QAAQ,EAAE;AACjD,IAAI,eAAe,CAAC,MAAM,GAAG,oCAAoC;AACjE,IAAI,SAAS,CAAC,UAAU,CAAC,GAAG,EAAE,OAAO,EAAE,eAAe,EAAE;AACxD,IAAI,GAAG,CAAC,QAAQ,GAAG,SAAS;AAC5B,EAAE;AACF,EAAE,aAAa,CAAC,oBAAoB,EAAE,eAAe,CAAC,GAAG,CAAC,EAAE,MAAM,CAAC;AACnE;AACA,SAAS,oBAAoB,GAAG;AAChC,EAAE,wBAAwB,EAAE;AAC5B,EAAE,MAAM,GAAG,GAAG,YAAY,CAAC,oBAAoB,EAAE,MAAM,CAAC;AACxD,EAAE,MAAM,GAAG,GAAG,UAAU,CAAC,GAAG,CAAC;AAC7B,EAAE,OAAO,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,GAAG,GAAG,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,KAAK,KAAK,OAAO,KAAK,KAAK,QAAQ,CAAC,GAAG,EAAE;AACjG;;;;"}